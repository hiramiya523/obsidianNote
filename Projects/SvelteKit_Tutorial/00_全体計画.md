# SvelteKit + TypeScript 移行チュートリアル方針

タグ: #sveltekit #typescript #tutorial #plan

---

## 📋 目次

- [[#1. 概要]]
- [[#2. 技術スタック]]
- [[#3. チュートリアル構成]]
- [[#4. 学習リソース]]
- [[#5. 評価とフィードバック]]
- [[#6. よくある質問とトラブルシューティング]]
- [[#7. 次のステップ]]
- [[#8. まとめ]]

---

## 1. 概要

### 1.1 目的
Alpine.js + Handlebarsベースの既存フロントエンドプロジェクト（`front-customer-northstar`）から、SvelteKit + TypeScriptへの移行を支援するための包括的なチュートリアルを作成する。

### 1.2 対象者
- SvelteKit未経験者
- TypeScript未経験者または初心者
- 既存のAlpine.jsプロジェクトに携わっている開発者

### 1.3 前提知識
- HTML/CSS/JavaScriptの基礎知識
- モダンなJavaScript（ES6+）の基本理解
- パッケージマネージャー（npm/pnpm）の使用経験
- ターミナル操作の基本

---

## 2. 技術スタック

### 2.1 コア技術
- **SvelteKit 2.x**: フルスタックフレームワーク
- **TypeScript 5.x**: 型安全性を提供する言語
- **Vite 7.x**: 高速なビルドツール
- **Tailwind CSS 4.x**: ユーティリティファーストのCSSフレームワーク

### 2.2 主要な概念
- **サーバーサイドレンダリング（SSR）**: サーバー側でのHTML生成
- **ファイルベースルーティング**: ディレクトリ構造によるルーティング
- **ロード関数**: データフェッチングとサーバーサイドロジック
- **リアクティビティ**: Svelteのリアクティブな状態管理
- **型安全性**: TypeScriptによる型チェック

### 2.3 既存プロジェクトとの違い

| 既存（Alpine.js） | 移行後（SvelteKit） |
|------------------|-------------------|
| クライアントサイドのみ | SSR + クライアントサイド |
| 手動ルーティング | ファイルベースルーティング |
| グローバル状態管理 | リアクティブな状態管理 |
| Handlebarsテンプレート | Svelteコンポーネント |
| 手動API呼び出し | ロード関数による自動データフェッチ |

---

## 3. チュートリアル構成

### 3.1 フェーズ1: 基礎編（1-2週間）

#### セクション1: 環境構築と基本概念
**目標**: 開発環境を構築し、SvelteKitの基本概念を理解する

1. **開発環境のセットアップ**
   - Node.js/npm/pnpmのインストール確認
   - SvelteKitプロジェクトの作成
   - エディタ（VS Code）の設定
   - TypeScriptの基本設定確認

2. **SvelteKitの基本概念**
   - プロジェクト構造の理解
   - `src/routes/` ディレクトリの役割
   - `src/lib/` ディレクトリの役割
   - `+page.svelte` と `+layout.svelte` の違い

3. **TypeScriptの基礎**
   - 型の基本（string, number, boolean, object）
   - インターフェースと型エイリアス
   - 関数の型定義
   - ジェネリクスの基本

**実践課題**:
- 簡単なHello Worldページを作成
- 基本的な型定義を含むコンポーネントを作成

---

#### セクション2: Svelteの基本構文
**目標**: Svelteのリアクティビティとコンポーネント構文を習得する

1. **リアクティビティの基礎**
   - `$:` リアクティブステートメント（Svelte 4/Legacy）
   - `$state()` と `$derived()` の使い分け（Svelte 5 Runes）
   - `$props()` によるプロップス定義
   - イベントハンドリング（`on:click`, `on:input`など）

2. **コンポーネントの作成**
   - コンポーネントの定義とエクスポート
   - プロップスの受け渡し
   - スロット（`<slot />` または `{@render}`）の使用
   - 子コンポーネントへのデータバインディング

3. **条件分岐とループ**
   - `{#if}` ブロック
   - `{#each}` ブロック
   - `{#await}` ブロック（非同期処理）

**実践課題**:
- カウンターコンポーネントの作成
- Todoリストアプリの作成（CRUD操作）
- モーダルコンポーネントの作成

---

#### セクション3: ルーティングとナビゲーション
**目標**: SvelteKitのファイルベースルーティングを理解する

1. **基本的なルーティング**
   - 静的ルート（`/about` → `src/routes/about/+page.svelte`）
   - 動的ルート（`[id]` パラメータ）
   - オプショナルルート（`[[slug]]`）
   - レストパラメータ（`[...path]`）

2. **レイアウトシステム**
   - `+layout.svelte` の作成と使用
   - ネストされたレイアウト
   - レイアウトグループ（`(group)`）

3. **ナビゲーション**
   - `<a>` タグと `<Link>` コンポーネント
   - `goto()` 関数によるプログラム的なナビゲーション
   - プリロード（`data-sveltekit-preload-data`）

**実践課題**:
- マルチページアプリケーションの作成
- 動的ルートを使用した詳細ページの実装
- ナビゲーションメニューの作成

---

### 3.2 フェーズ2: 中級編（2-3週間）

#### セクション4: データフェッチングとロード関数
**目標**: サーバーサイドとクライアントサイドでのデータ取得を理解する

1. **ロード関数の基礎**
   - `+page.ts` と `+page.server.ts` の違い
   - `+layout.ts` と `+layout.server.ts` の違い
   - `PageLoad` と `PageServerLoad` 型
   - `event` オブジェクトの理解

2. **API通信の実装**
   - `universalFetch` 関数の理解（既存プロジェクトの実装）
   - Laravel Sanctum認証の統合
   - CSRFトークンの処理
   - エラーハンドリング

3. **フォーム処理**
   - `<form>` 要素と `use:enhance`
   - `+page.server.ts` でのフォームアクション
   - バリデーションとエラー表示
   - リダイレクト処理

**実践課題**:
- ログインフォームの実装
- 検索機能の実装（API連携）
- CRUD操作の実装（一覧、作成、編集、削除）

---

#### セクション5: 状態管理とストア
**目標**: アプリケーション全体での状態管理を理解する

1. **Svelteのストア**
   - `writable` ストア
   - `readable` ストア
   - `derived` ストア
   - ストアの購読（`$store` 構文）
   - **Note**: Svelte 5では `$state()` を`.svelte.ts`ファイルでエクスポートするパターンも有効

2. **コンテキストAPI**
   - `setContext` と `getContext`
   - プロバイダーパターンの実装
   - 認証状態の管理

3. **既存プロジェクトからの移行**
   - Alpine.jsの `x-data` からSvelteストアへの移行
   - グローバル変数（`window.app_config`など）の扱い
   - セッション管理

**実践課題**:
- 認証状態の管理システムの実装
- ショッピングカート機能の実装
- テーマ切り替え機能の実装

---

#### セクション6: TypeScriptの実践的な使い方
**目標**: プロジェクトで使用するTypeScriptの高度な機能を習得する

1. **型定義の作成**
   - APIレスポンスの型定義
   - フォームデータの型定義
   - カスタム型とユニオン型
   - 型ガードの実装

2. **ジェネリクスの活用**
   - ジェネリック関数の作成
   - ジェネリックコンポーネント
   - 型パラメータの制約

3. **既存コードとの統合**
   - JavaScriptからTypeScriptへの移行
   - 型アサーション（`as`）の適切な使用
   - `any` 型の回避方法

**実践課題**:
- APIレスポンスの型定義を作成
- 既存のJavaScript関数をTypeScriptに変換
- 型安全なユーティリティ関数の作成

---

### 3.3 フェーズ3: 上級編（2-3週間）

#### セクション7: コンポーネント設計と再利用性
**目標**: 保守性の高いコンポーネント設計を習得する

1. **コンポーネントの設計原則**
   - 単一責任の原則
   - プロップスの設計
   - イベントの設計
   - スロットの活用

2. **既存コンポーネントの移行**
   - Alpine.jsコンポーネントからSvelteコンポーネントへの移行
   - 既存のUIライブラリ（bits-ui）の活用
   - カスタムコンポーネントの作成

3. **コンポーネントライブラリの構築**
   - `$lib/components` の構造
   - コンポーネントのエクスポートとインポート
   - スタイルの統一（Tailwind CSS）

**実践課題**:
- 既存のAlpine.jsコンポーネントをSvelteに移行
- 再利用可能なフォームコンポーネントの作成
- モーダル、ドロップダウンなどのUIコンポーネントの作成

---

#### セクション8: スタイリングとTailwind CSS
**目標**: Tailwind CSSを活用した効率的なスタイリングを習得する

1. **Tailwind CSSの基礎**
   - ユーティリティクラスの使い方
   - レスポンシブデザイン
   - ダークモードの実装
   - カスタムクラスの作成

2. **既存スタイルの移行**
   - 既存CSSからTailwindへの変換
   - カスタムコンポーネントのスタイリング
   - アニメーションとトランジション

3. **デザインシステムの構築**
   - デザイントークンの定義
   - コンポーネントのバリアント
   - 一貫性のあるデザインの実現

**実践課題**:
- 既存ページのスタイルをTailwindで再現
- レスポンシブなレイアウトの実装
- アニメーション付きコンポーネントの作成

---

#### セクション9: パフォーマンス最適化
**目標**: アプリケーションのパフォーマンスを最適化する

1. **コード分割とプリロード**
   - 動的インポート
   - ルートベースのコード分割
   - リソースのプリロード

2. **画像とアセットの最適化**
   - 画像の最適化
   - フォントの最適化
   - 静的アセットの管理

3. **レンダリング最適化**
   - SSR vs CSR の選択
   - 部分的なハイドレーション
   - 遅延ローディング

**実践課題**:
- 大きなリストの仮想スクロール実装
- 画像の遅延ローディング
- パフォーマンスメトリクスの測定と改善

---

#### セクション10: テストとデバッグ
**目標**: テストとデバッグのベストプラクティスを習得する

1. **テストの基礎**
   - ユニットテストの書き方
   - コンポーネントテスト
   - E2Eテストの基本

2. **デバッグ技術**
   - ブラウザ開発者ツールの活用
   - TypeScriptの型エラーの解決
   - サーバーサイドのデバッグ

3. **エラーハンドリング**
   - エラーページの作成（`+error.svelte`）
   - エラーバウンダリ
   - ロギングの実装

**実践課題**:
- コンポーネントのユニットテストを作成
- エラーハンドリングの実装
- デバッグワークフローの確立

---

### 3.4 フェーズ4: 実践編（3-4週間）

#### セクション11: 既存プロジェクトの移行実践
**目標**: 実際の既存プロジェクトの一部を移行する

1. **移行戦略の立案**
   - 移行対象の選定
   - 段階的な移行計画
   - 既存機能の分析

2. **認証システムの移行**
   - Laravel Sanctum認証の統合
   - セッション管理
   - 認証ガードの実装

3. **主要機能の移行**
   - 予約フロー（`reservation-flow/`）の移行
   - プラン表示（`plan/`）の移行
   - マイページ（`mypage/`）の移行

**実践課題**:
- 既存の1つのページを完全に移行
- 認証フローの実装
- 既存APIとの統合

---

#### セクション12: 外部ライブラリの統合
**目標**: 既存プロジェクトで使用しているライブラリをSvelteKitに統合する

1. **日付ピッカーの統合**
   - Flatpickrの統合
   - 多言語対応（日本語、繁体字中国語）

2. **スライダーの統合**
   - Swiperの統合
   - カスタマイズと設定

3. **その他のライブラリ**
   - Font Awesomeの統合
   - ライトボックス（Luminous）の統合
   - Alpine.jsからSvelteへの移行パターン

**実践課題**:
- 既存のライブラリをSvelteコンポーネントとしてラップ
- 再利用可能なラッパーコンポーネントの作成

---

#### セクション13: デプロイとCI/CD
**目標**: 本番環境へのデプロイとCI/CDパイプラインを理解する

1. **ビルドとデプロイ**
   - プロダクションビルド
   - アダプターの選択（`@sveltejs/adapter-node`）
   - 環境変数の管理

2. **CI/CDパイプライン**
   - GitLab CIの設定（既存の`.gitlab-ci.yml`を参照）
   - テストの自動実行
   - デプロイメントの自動化

3. **環境管理**
   - 開発環境、ステージング環境、本番環境
   - 環境変数の設定
   - 設定ファイルの管理

**実践課題**:
- ローカルでのプロダクションビルドの実行
- CI/CDパイプラインの設定確認
- デプロイメント手順の文書化

---

## 4. 学習リソース

### 4.1 公式ドキュメント
- [SvelteKit公式ドキュメント](https://kit.svelte.dev/)
- [Svelte公式ドキュメント](https://svelte.dev/)
- [TypeScript公式ドキュメント](https://www.typescriptlang.org/)
- [Tailwind CSS公式ドキュメント](https://tailwindcss.com/)

### 4.2 推奨学習順序
1. TypeScriptの基礎（型、インターフェース、関数）
2. Svelteの基本構文（リアクティビティ、コンポーネント）
3. SvelteKitのルーティングとロード関数
4. 既存プロジェクトのコードを読む
5. 小さな機能から移行を開始

### 4.3 参考プロジェクト
- `/workspace/svelte-ts`: 既存のSvelteKitプロジェクト（参考実装）
- `/workspace/front-customer-northstar`: 移行元のプロジェクト

---

## 5. 評価とフィードバック

### 5.1 各セクションの評価基準
- **基礎編**: 基本的なコンポーネントを作成できる
- **中級編**: API連携と状態管理を実装できる
- **上級編**: 複雑な機能を設計・実装できる
- **実践編**: 既存プロジェクトの一部を移行できる

### 5.2 進捗確認方法
- 各セクション終了時に実践課題を提出
- コードレビューによるフィードバック
- ペアプログラミングセッション

---

## 6. よくある質問とトラブルシューティング

### 6.1 TypeScript関連
- **Q: 型エラーが多すぎて進められない**
  - A: 最初は `any` 型を使用しても良い。徐々に型を厳密にしていく
- **Q: 既存のJavaScriptコードをどう移行するか**
  - A: ファイル拡張子を `.js` から `.ts` に変更し、段階的に型を追加

### 6.2 SvelteKit関連
- **Q: SSRとCSRの違いがわからない**
  - A: SSRはサーバーでHTMLを生成、CSRはブラウザで生成。SvelteKitはデフォルトでSSR
- **Q: ロード関数でエラーが発生する**
  - A: `+page.server.ts` では `event` オブジェクトから `cookies` を取得できることを確認

### 6.3 移行関連
- **Q: Alpine.jsの `x-data` をどう移行するか**
  - A: Svelteの `$state()` やストアを使用。コンポーネント内の状態は `$state()`、グローバル状態はストア
- **Q: 既存のAPIエンドポイントをどう使うか**
  - A: `universalFetch` 関数を使用。`+page.server.ts` で `event.fetch` を渡す

---

## 7. 次のステップ

### 7.1 チュートリアル完了後
1. 既存プロジェクトの完全な移行計画を立てる
2. チーム全体でのコードレビュー体制を確立
3. ベストプラクティスの文書化
4. 継続的な学習と改善

### 7.2 推奨される追加学習
- Svelte 5の新機能（Runes、Snippetsなど）
- パフォーマンス最適化の高度なテクニック
- アクセシビリティ（a11y）の実装
- 国際化（i18n）の実装

---

## 8. まとめ

このチュートリアルは、SvelteKit + TypeScript未経験者が段階的に学習し、既存プロジェクトを移行できるよう設計されています。各セクションは独立して学習できますが、推奨される順序で進めることで、より効率的に学習できます。

重要なのは、完璧を目指すのではなく、実際にコードを書きながら学ぶことです。エラーに遭遇したら、それは学習の機会です。チームで協力しながら、一緒に成長していきましょう。

